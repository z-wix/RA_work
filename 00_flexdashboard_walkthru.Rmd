---
title: "00 Flexdashboard Walkthrough"
subtitle: "MKTG 411 Marketing Analytics"
output: 
  ioslides_presentation:
    widescreen: true
---

## Interactive Dashboards (image of dashboard)

<center>
![](~/Work/Dotson RA/RA_work/flexdashboard_hex.png){width=650px, hieght=500px}
</center>

## Why Dashboards?

- Dashboards create an easy way to interpret and report data to others.
  + Key performance indicators
  + Data visualizations
  + Exploring Data
- Interactive Dashboards allow users to manipulate the data that is used in the visualizations


## Flexdashboard

- __flexdashboard__ is an R package that allows you to easily build dashboards using _Rmarkdown_.

- Utilizing _shiny_ functions in a dashboard will help create interactive dashboards.

## Example Dasbhoards

(Maybe some images of dashboards so they know what they look like. Or we can use some that I have built before and play around with them just so they get the gist of it)

## Set up

- Open a new document in R
- Choose drop down and select Rmarkdown
- Choose from Template
- Select flexdashboard

## Elements of flexdashboard

- yaml header
- Layout (columns or rows)
- Code chunks
- Charts
- Sidebar

## YAML Header

- As an Rmarkdown document, there are addition parameters in the yaml output that make it a flexdashboard:

`flexdashboard::flex_dashboard:`  
` orientation: rows`  
` vertical_layout: scroll`  
    
- Additionally, to use shiny functions you include:

`runtime: shiny`

## Layout

The yaml header influences the layout of the dashboard

- orientation is the layout of the charts which can be _columns_ or _rows_

- vertical_layout changes how it fits the web page with _fill_ or _scroll_ as options

## Making a Column or Row

Columns and Rows are defined by the level 2 markdown header annotation (`-------------`)
- Code chunks following the header will show up in that column/row
- Data width or height can be modified above header annotation between {} (`{data-width=650px}`)

## Code Chunks

Data Visuals (i.e. graphs and tables) and Rendered elements (i.e. `renderText()` and `renderValue()`) will show on the dashboard.

Data cleaning, manipulation, etc can be performed in the background just showing the data insights on the dashboard.

---

Chunks will be given titles by using markdown header (`###`)

Additional code chunks under the column/row header will be included in that column/row

---

Example Images of the different layouts

---


## Packages

We use the _flexdashboard_ and _shiny_ packages to access the functions that allow you to build interactive plots in a dashboard.
```{r message=FALSE}
library(tidyverse)
library(flexdashboard)
library(shiny)

mpg
```

## Adding a Chart

Make a static ggplot graph. Only __outputs__ will be displayed in the chart

```{r}
car_count <- mpg %>% 
  count(manufacturer, drv)

ggplot(car_count, aes(x = manufacturer, y = n)) +
  geom_col()
```

## Visualizing Discrete Data

ggplot2 uses a consistent **grammar of graphics** built with **layers**.

1. Data – Data to visualize.
2. Aesthetics – Mapping graphical elements to data.
3. Geometries – Or “geom,” the graphic representing the data.

---

Plot our `car_count` data (note how `+` is different from `%>%`).

```{r}

```

---

- Let’s visualize a second variable. Add the aesthetic `fill = drv`.
- The geom `position` argument is set to `"stack"` by default. Try `"dodge"` and `"fill"` instead.

---

```{r}
ggplot(car_count, aes(x = manufacturer, y = n, fill = drv)) +
  geom_col()
```

---

```{r}
ggplot(car_count, aes(x = manufacturer, y = n, fill = drv)) +
  geom_col(position = "dodge")
```

---

```{r}
ggplot(car_count, aes(x = manufacturer, y = n, fill = drv)) +
  geom_col(position = "fill")
```

## Describing Continuous Data

The simplest numeric summary for a continuous variable is a **mean**.

```{r}
mpg %>%
  summarize(avg_hwy = mean(hwy))
```

Note that `summarize()` is a more general version of `count()`.

---

- Compute the mean of both highway and city miles per gallon.
- We can also compute the **mode**, **median**, **variance**, **standard deviation**, **minimum**, **maximum**, etc.

---

```{r}
mpg %>% 
  summarize(avg_hwy = mean(hwy), avg_cty = mean(cty))
```

## Visualizing Continuous Data

With discrete data, we had to create a summary before we created a plot (which is typical).

For continuous data, we can often plot without a summary. Let’s plot the **distribution** of highway miles per gallon.

---

```{r}
ggplot(mpg, aes(x = hwy)) +
  geom_histogram()
```

---

Visualize the relationship between highway and city MPG.

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_point()
```

---

- What do we do if there is **overplotting**? There’s a geom for that.
- Play with the `size` and `alpha` geom arguments.
- Add a `geom_smooth()` layer.

---

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_jitter(size = 3, alpha = 0.5)
```

---

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_jitter(size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE)
```

## Describing Discrete and Continuous Data

**Grouped summaries** provide a powerful solution for describing a combination of discrete and continuous data.

```{r}
mpg %>%
  group_by(manufacturer) %>%
  summarize(
    n = n(),
    avg_hwy = mean(hwy),
    avg_cty = mean(cty)
  )
```

---

- `count()` is a **wrapper** around a grouped summary with `n()`.
- Grouping by a discrete variable is equivalent to filtering the data separately for each value of the group variable.
- Now group by manufacturer and fuel type and arrange the summary in descending order by average highway MPG.

---

```{r}
mpg %>% 
  group_by(manufacturer, fl) %>% 
  summarize(
    n = n(), 
    avg_hwy = mean(hwy), 
    avg_cty = mean(cty)
  ) %>% 
  arrange(desc(avg_hwy))
```

## Visualizing Discrete and Continuous Data

There are geoms specific to visualizing the relationship between discrete and continuous data.

---

```{r}
ggplot(mpg, aes(x = manufacturer, y = hwy)) +
  geom_boxplot()
```

---

But there are a variety of other options to quickly create impressive visuals.

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_jitter(size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE)
```

---

- Add the aesthetic `color = fl`.
- Add the layer `facet_wrap(~ manufacturer)`.

---

```{r}
ggplot(mpg, aes(x = hwy, y = cty, color = fl)) +
  geom_jitter(size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE)
```

---

```{r}
ggplot(mpg, aes(x = hwy, y = cty, color = fl)) +
  geom_jitter(size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ manufacturer)
```

## Wrapping Up

*Summary*

- How to open a flexdashboard template through Rmarkdown.
- How to modify the layout of the dashboard.
- Create an interactive plot using a sidebar and `selectInput()`. 

*Next Time*

- 

*Supplementary Material*

- Flexdashboard for R webpage: 
  + link : _https://rmarkdown.rstudio.com/flexdashboard/index.html_
- RStudio’s Rmarkdown and Flexdashboard Cheatsheets

## Exercise 0

Open the exercise via the RStudio Cloud workspace and do the following.

1. Load the tidyverse.
2. Explore `mpg` using the functions we've covered.
3. Provide a few interesting descriptions (numeric summaries) and visualizations (graphical summaries).
4. Practice good coding conventions: Comment often, write in consecutive lines of code using the `%>%`, and use the demonstrated style (e.g., variable names, spacing within functions).
5. Export the R script and upload to Learning Suite.